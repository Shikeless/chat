<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<link href="./src/styles/index.css" rel="stylesheet" type="text/css"></link>
</head>
<body>
	<div class="users">
	<div class="user-box">
		<img class="user-image" src="./src/img/noImage.png">
		<span id="user-name" style="bottom: 25px; left: 10px; position: relative;"><b>Добро пожаловать!</b>
	</div>
	<div class="members-box">
		<span id="memmbers-number"><b>Участники ( )</b></span>
		<div class="members-list">
		</div>
	</div>
</div>
<div class="chat">
	<ul id="chat-list">
	</ul>
	<div class="login">
		<b>Авторизация</b>
		<div class="login-form-box">
			<input id="name" type="text" name="name" placeholder="ФИО">
			<input id="nickname" type="text" name="nickname" placeholder="Никнейм">
    			<button class="button">Войти</button>
    		</div>
		</div>
	</div>
	<div class="message">
		<input id="mes" type="text" name="message" placeholder="Введите сообщение">
		<button id="send" class="button">Отправить</button>
	</div>
</div>
	<script>
		const CHAR_RETURN = 13;

		const socket = new WebSocket('ws://127.0.0.1:8080'); //проверить адресс
		const chat = document.getElementById('chat-list');
		const msg = document.getElementById('mes');
		// const stat = document.getElementById('status');
		const but = document.getElementById('send');
		msg.focus();

		const writeLine = text => {
			const line = document.createElement('li');
			line.innerHTML = `<p>${text}</p>`;
			chat.appendChild(line);
		};

		// socket.onopen = () => {
		// 	writeLine('connected');
		// }

		// socket.onclose = () => {
		// 	writeLine('closed');
		// }

		socket.onmessage = event => {
			writeLine(event.data);
		};

		msg.addEventListener('keydown', event => {
			if (event.keyCode === CHAR_RETURN) {
				const s = msg.value;
				msg.value = '';
				writeLine(s);
				socket.send(s);	
			}
		});

		// but.addEventListener('click', event => {
		// 	console.log(but);
		// 	const s = mes.value;
		// 	mes.value = '';
		// 	writeLine(s);
		// 	socket.send(s);	
		// });
	</script>
</body>
</html>